var BaseTreeTable=function(){function e(){this.eventHandlerDictionary=[],this.parentContainerId="",this.maxColumnWidth=500}return e.prototype.getContext=function(){return document.getElementById(this.parentContainerId)},e.prototype.getElements=function(e){var t='[data-ParentId="'+e+'"]',n=this.getContext().querySelectorAll(t);return n},e.prototype.getChildren=function(e){if(null==e||""==e)return new Array;for(var t=this.getContext().querySelectorAll("tr"),n=new Array,i=0;i<t.length;i++)t[i].getAttribute("data-parentid")==e&&n.push(t[i]);return n},e.prototype.hasClass=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},e.prototype.showChildren=function(e,t,n,i){var a=this.getContext().querySelector('[data-id="'+e+'"]');void 0!=a&&(a.className=a.className.replace(" collapsed",""));for(var o=this.getChildren(e),l=0;l<o.length;l++){var r=o[l].dataset.id,s='[data-id="'+r+'"] td',d=o[l].querySelector(s+" .vjoinendcollapsible, "+s+" .vjoincollapsible");null!==d&&this.showChildren(r,null,null,null),o[l].style.display="table-row"}void 0!=t&&(t.className="base "+i,this.registerEventSingle(t,"click",this.eventHandlerDictionary[i]))},e.prototype.hideChildren=function(e,t,n,i){var a=this.getContext().querySelector('[data-id="'+e+'"]');void 0!=a&&(a.className=a.className+" collapsed"),void 0!=t&&(this.hideUnderlyingElements(e),t.className="base "+i,this.registerEventSingle(t,"click",this.eventHandlerDictionary[i]))},e.prototype.hideUnderlyingElements=function(e){for(var t=this.getChildren(e),n=0;n<t.length;n++){var i=t[n].dataset.id;this.hideUnderlyingElements(i),t[n].style.display="none"}},e.prototype.createSpan=function(e){var t=document.createElement("SPAN");return t.className=e,t},e.prototype.addIdentation=function(e,t,n){t+=1;for(var i=0;i<e.length;i++){var a=t,o=e[i].dataset.id,l=e[i].getElementsByTagName("td")[0],r=this.getChildren(o),s=r.length>0,d=i===e.length-1;d?n[t-1]=this.createSpan("base spacer"):n[t-1]=this.createSpan("base vline");var c=null,p=l.parentElement;for(this.hasClass(p,"collapsed")&&(c="collapsed");a-1>=1;)a-=1,a===t-1&&"collapsed"===c&&s&&!d?(l.insertBefore(this.createSpan("base vjoinexpandable"),l.childNodes[0]),this.hideUnderlyingElements(p.dataset.id)):a===t-1&&"collapsed"===c&&s&&d?(l.insertBefore(this.createSpan("base vjoinendexpandable"),l.childNodes[0]),this.hideUnderlyingElements(p.dataset.id)):a===t-1&&s&&d?l.insertBefore(this.createSpan("base vjoinendcollapsible"),l.childNodes[0]):a===t-1&&s&&!d?l.insertBefore(this.createSpan("base vjoincollapsible"),l.childNodes[0]):a!==t-1||s||d?a===t-1&&!s&&d?l.insertBefore(this.createSpan("base vjoinend"),l.childNodes[0]):void 0!==n[a]&&l.insertBefore(n[a].cloneNode(),l.childNodes[0]):l.insertBefore(this.createSpan("base vjoin"),l.childNodes[0]);this.addIdentation(r,t,n)}},e.prototype.insertIndentations=function(){for(var e=this.getContext().querySelectorAll("tr:not([data-parentId])"),t=0;t<e.length;t++){var n=1,i=e[t].dataset.id,a=this.getChildren(i),o=t===e.length-1,l=[];o?l[n]=this.createSpan("base spacer"):l[n]=this.createSpan("base vline"),this.addIdentation(a,n,l)}},e.prototype.getParentElementId=function(e){var t=e.parentElement.parentElement,n=t.dataset.id;return n},e.prototype.initEventHandlerDictionary=function(){var e=this;this.eventHandlerDictionary.vjoinexpandable=function(){var t=e.getParentElementId(this);e.showChildren(t,this,"vjoinexpandable","vjoincollapsible")},this.eventHandlerDictionary.vjoincollapsible=function(){var t=e.getParentElementId(this);e.hideChildren(t,this,"vjoincollapsible","vjoinexpandable")},this.eventHandlerDictionary.vjoinendexpandable=function(){var t=e.getParentElementId(this);e.showChildren(t,this,"vjoinendexpandable","vjoinendcollapsible")},this.eventHandlerDictionary.vjoinendcollapsible=function(){var t=e.getParentElementId(this);e.hideChildren(t,this,"vjoinendcollapsible","vjoinendexpandable")},this.eventHandlerDictionary.pushpinClick=function(t){for(var n=this,i=this;(i=i.parentElement)&&!i.classList.contains("popout"););i.removeEventListener("mouseout",e.eventHandlerDictionary.popOutMouseOut),n.className.indexOf("pinned")>-1?n.className=n.className.replace(" pinned",""):n.className+=" pinned"},this.eventHandlerDictionary.descriptionMouseIn=function(t){this.className.indexOf("popouthover")===-1&&(this.className+=" popouthover"),e.applyShowAllStyles(this);var n=this.querySelector(".pushpin");n.style.display="initial"},this.eventHandlerDictionary.descriptionMouseOut=function(t){var n=this.querySelector(".pinned");if(null===n){var i=this.querySelector(".pushpin");i.style.display="none",e.applyHideLongTextStyles(this),this.className=this.className.replace(" popouthover","")}else e.applyShowAllStyles(this),this.style.display="inline-block"}},e.prototype.registerEventSingle=function(e,t,n){"click"===t?e.onclick=n:"dblclick"===t?e.ondblclick=n:e.addEventListener(t,n)},e.prototype.registerEvent=function(e,t,n){for(var i=this.getContext().getElementsByClassName(e),a=0;a<i.length;a++){var o=i[a];this.registerEventSingle(o,t,n)}},e.prototype.registerForEvents=function(){this.registerEvent("vjoinexpandable","click",this.eventHandlerDictionary.vjoinexpandable),this.registerEvent("vjoincollapsible","click",this.eventHandlerDictionary.vjoincollapsible),this.registerEvent("vjoinendcollapsible","click",this.eventHandlerDictionary.vjoinendcollapsible),this.registerEvent("vjoinendexpandable","click",this.eventHandlerDictionary.vjoinendexpandable),this.registerEvent("pushpin","click",this.eventHandlerDictionary.pushpinClick),this.registerEvent("popout","mouseover",this.eventHandlerDictionary.descriptionMouseIn),this.registerEvent("popout","mouseout",this.eventHandlerDictionary.descriptionMouseOut)},e.prototype.resizeToMaxColumnWidth=function(e){for(var t=document.getElementById(e),n=t.getElementsByTagName("td"),i=0;i<n.length;i++){var a=n[i];if("description"===a.className){var o=a.getBoundingClientRect();if(o.width>this.maxColumnWidth){a.className+=" popout",this.applyHideLongTextStyles(a);var l=document.createElement("div"),r=document.createElement("span"),s=a.childNodes[0];r.className="glyphicon glyphicon-pushpin pushpin",l.className="spanContainer",l.appendChild(r),a.insertBefore(l,s)}}}},e.prototype.applyShowAllStyles=function(e){e.style.overflow="visible",e.style.whiteSpace="normal"},e.prototype.applyHideLongTextStyles=function(e){e.style.overflow="hidden",e.style.whiteSpace="nowrap"},e.prototype.init=function(e,t){void 0===t&&(t=!1),this.parentContainerId=e,this.initEventHandlerDictionary(),this.insertIndentations(),this.resizeToMaxColumnWidth(e),this.registerForEvents(),t&&this.expandPathToSelectedNode()},e.prototype.expandPathToSelectedNode=function(){var e=this.getContext().querySelector(".treenode.selected");void 0!=e&&(this.collapseAllNodes(),this.expandPathToNode(e.getAttribute("data-id")))},e.prototype.collapseAllNodes=function(){$(this.getContext().querySelectorAll(".vjoincollapsible, .vjoinendcollapsible")).trigger("click")},e.prototype.expandPathToNode=function(e){var t=this,n=this.getPathToNode(e);n.forEach(function(e){$(t.getContext().querySelector('[data-id="'+e+'"]').querySelectorAll(".vjoinexpandable, .vjoinendexpandable")).trigger("click")})},e.prototype.getPathToNode=function(e){for(var t=[],n=this.getContext().querySelector('[data-id="'+e+'"]').getAttribute("data-parentid");void 0!=n;)t.push(n),n=this.getContext().querySelector('[data-id="'+n+'"]').getAttribute("data-parentid");return t},e}();